#!@SH@

# Part of @PACKAGE_STRING@
# For bug reports, see "@PACKAGE_BUGREPORT@"

set -o errexit

# Variables set by the configure script:
prefix="@prefix@"
exec_prefix="@exec_prefix@"

MKTEMP="@MKTEMP@"
MKTEMP_TEMPLATE="@MKTEMP_TEMPLATE@"
PAX="@PAX@"

UTILITY_NAME=shvenv
# Get common functions (perrorf, pinfof, output_version, command_line_error)
# shellcheck source=./shell-common.shlib
. "@libexecdir@/shell-common.shlib"

quiet=false     # when true, informational messages are not outputted

while getopts 'qvV' opt; do
    case $opt in
        q) quiet=true   ;;
        v) quiet=false  ;;
        V) output_version
           exit 0       ;;
        *) command_line_error
           exit 1
    esac
done

dir=$1

if [ -d "$dir" ]; then
    perrorf 'Directory already exists: %s\n' "$dir"
    exit 1
fi
if ! mkdir -p "$dir"; then
    perrorf 'Can not create directory: %s\n' "$dir"
    exit 1
fi

! "$quiet" && pinfof 'Created directory %s\n' "$dir"

absdir=$( cd "$dir" && printf '%s' "$PWD" )

cat >"$dir/activate" <<END_ACTIVATE
#!/bin/sh

shell -d "$absdir"
END_ACTIVATE

# vim: ft=sh
